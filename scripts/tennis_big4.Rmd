---
title: "How big are the big 4?"
author: "Gurudev Ilangovan"
date: "September 15, 2017"
output: html_document
---
```{r, include=FALSE}
library(tidyverse)
library(magrittr)
library(purrr)
library(stringr)
library(forcats)



df_tennis <- read_csv("../data/atp_matches_all.csv")

nplayers <- 4
years_to_aggregate <- 10
y_now <- 2017
y_beg <- 1920
cuts <- seq(y_now,y_beg,by = -years_to_aggregate)

df_tennis <- 
  df_tennis %>%
    mutate(tourney_name = case_when(
                        tourney_name == "Australian Chps." ~ "Australian Open",
                        tourney_name == "Us Open" ~ "US Open",
                        TRUE ~ tourney_name
                      ),
           year = as.integer(str_sub(tourney_date,1,4)),
           year_aggregated = cut(year, breaks = cuts, dig.lab = 10)
           ) 

grand_slam_wins <- df_tennis %>%
  filter(tourney_level == "G" & round == "F") 
```


Tennis has always had greats in every era. Why then is this era called as **golden era in tennis**? More specifically, why is the quartet of Roger Federer, Rafael Nadal, Novak Djokovic and Andy Murray called as the *big four*?  

First let's take a customary look at the slam counts for players with more than 2 slams. 

```{r echo=FALSE}
grand_slam_wins %>%
  group_by(winner_name) %>%
    mutate(n = n()) %>%
      filter(n>2) %>% 
    ggplot(aes(fct_rev(fct_infreq(winner_name, ordered = T)), 
               fill = fct_rev(factor(year_aggregated)))) +
      geom_bar() +
      coord_flip() +
      scale_y_continuous(breaks = seq(1,20,1)) +
      scale_fill_brewer(palette = "Dark2") +
      theme_minimal() +
      theme(panel.grid.minor.x = element_blank(),
            panel.grid.major.y = element_blank(),
            panel.grid.minor.y = element_blank())

# scale_fill_manual(values = c("darkgoldenrod2", "coral3", "blue3", "chartreuse4")) +
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
